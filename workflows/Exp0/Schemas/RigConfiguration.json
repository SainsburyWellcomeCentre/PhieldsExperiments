{
    "$id": "...h",
    "$schema": "https://json-schema.org/draft-07/schema",
    "description": "Describes the hardware and tracking configuration for the rig",
    "title": "RigConfig",
    "definitions": 
    {
        "loomTrigger":
        {
            "properties": 
            {
                "trigger":
                {
                    "$ref":"LoomConfiguration.json#/definitions/loomAction"
                }
            }
        },
        "clockSynchronizerName":
        {
            "enum": ["TimestampGeneratorGen3","ClockSynchronizer"],
            "default": "TimestampGeneratorGen3",
            "type": "string"
        },
        "cameraControllerName":
        {
            "enum": ["Behavior","CameraControllerGen2","OutputExpander"],
            "default": "CameraControllerGen2",
            "type": "string"
        },
        "cameraTriggerName":
        {   
            "enum": ["Trigger0","Trigger1"],
            "default": "Trigger1",
            "type": "string"

        },
        "cameraTriggerSource":
        {
            "properties": {
                "TriggerName":
                { 
                    "$ref":"#/definitions/cameraTriggerName",
                    "default": "Trigger0"
                },
                "triggerFrequency":
                {
                    "type":"integer",
                    "default":"50"
                }
            }
        },
        "cameraName":
        {
            "enum": ["CameraTop","CameraSide"],
            "default": "CameraTop",
            "type": "string"
        },
        "spinnakerSettings": {
            "properties": {
                "cameraName":
                {
                    "$ref":"#/definitions/cameraName",
                    "default": "CameraTop"
                },
                "triggerName":
                {
                    "$ref":"#/definitions/cameraTriggerName"
                },
                "exposureTime": {
                    "type": "number",
                    "default": 15000,
                    "minimum": 0,
                    "description": "The exposure time for the camera (in microseconds)"
                },
                "serialNumber": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": "00000",
                    "description": "The serial number of the camera"
                },
                "gain": {
                    "type": "number",
                    "default": 1,
                    "minimum": 0,
                    "description": "The camera gain"
                },
                "binning": {
                    "type": "integer",
                    "default": 1,
                    "minimum": 1,
                    "description": "The binning setting for the camera"
                }
            },
            "required": [
                "cameraName",
                "triggerName",
                "exposureTime",
                "serialNumber",
                "gain",
                "binning"
            ]
        }
    },
    "properties": {
        "clockSynchronizer":
        {
            "properties": 
            {
                "deviceName":
                {
                    "$ref":"#/definitions/clockSynchronizerName"
                },
                "portName": 
                {
                    "type": "string",
                    "default": "COM9",
                    "description": "The COM port for the timestamp generator board"
                }
            },
            "required": [
                "deviceName",
                "portName"
            ]
        },
        "cameraController":
        {
            "properties": 
            {
                "deviceName":
                {
                    "$ref":"#/definitions/cameraControllerName"
                },
                "portName": 
                {
                    "type": "string",
                    "default": "COM7",
                    "description": "The COM port for the camera controller board"
                },
                "triggers":{
                    "type":"array",
                    "items": {
                        "$ref":"#/definitions/cameraTriggerSource"
                    }
                }
            },
            "required": [
                "deviceName",
                "portName",
                "triggers"
            ]
        },
        "cameras":
        {
            "type":"array",
            "items": 
            {
                "$ref": "#/definitions/spinnakerSettings"
            }
        },
        "looms":
        {
            "type" : "array",
            "items":
            {
                "$ref": "LoomConfiguration.json#/definitions/mechanicalLoom"
            }
        }
    },
    "required": [
        "clockSynchronizer",
        "cameraController",
        "cameras"
    ]
}
